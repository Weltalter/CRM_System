<form action="#" id="ChangeClient" method="post" enctype="multipart/form-data">
    <div style="font-weight: 700;
                font-size: 16px;
                margin: 10px">
        <p>
            Заполните форму, чтобы изменить существующую запись клиента.
        </p>
    </div>
    <div style="font-weight: 700;
                margin: 10px">
        Введите ID клиента, данные которого вы хотите изменить.
    </div>
    <div>
        <input Placeholder="ID" tabindex="1" name="ClientID" type="text" class="form_input _req _ID" />
    </div>
    <div>
        <p>
            <input Placeholder="Фамилия" tabindex="2" name="MiddleName" type="text" class="form_input _req _name" />
        </p>
    </div>
    <div>
        <p>
            <input Placeholder="Имя" tabindex="3" name="FirstName" type="text" class="form_input _req _name" />
        </p>
    </div>
    <div>
        <p>
            <input Placeholder="Отчество" tabindex="4" name="LastName" type="text" class="form_input _req _name" />
        </p>
    </div>
    <div style="font-weight: 700">
        Дата рождения
    </div>
    <div>
        <input tabindex="5" name="BirthDate" type="date" class="form_input _req"  />
    </div>
    <div>
        <button tabindex="6" type="submit" style="float: left">Изменить</button>
        <button tabindex="7" type="reset">Очистить</button>
    </div>
</form>

<script>

    const form = document.getElementById('ChangeClient');

    const clientIDInput = document.querySelector('input[name="ClientID"]');
    const middleNameInput = document.querySelector('input[name="MiddleName"]');
    const firstNameInput = document.querySelector('input[name="FirstName"]');
    const lastNameInput = document.querySelector('input[name="LastName"]');
    const birthDateInput = document.querySelector('input[name="BirthDate"]');

    form.addEventListener('submit', function (event) {
        event.preventDefault();

        const clientIDScript = clientIDInput.value;
        const middleNameScript = middleNameInput.value;
        const firstNameScript = firstNameInput.value;
        const lastNameScript = lastNameInput.value;
        const birthDateScript = birthDateInput.value;

        console.log('ID клиента:', clientIDScript);
        console.log('Фамилия:', middleNameScript);
        console.log('Имя:', firstNameScript);
        console.log('Отчество:', lastNameScript);
        console.log('Дата рождения:', birthDateScript);

        const client = {
            clientID: clientIDScript,
            firstName: firstNameScript,
            middleName: middleNameScript,
            lastName: lastNameScript,
            birthdate: birthDateScript
        };

        let error = formValidate(form);

        if (error === 0) {
            fetch('/JScript/ChangeClient', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(client)
            })
                .then((response) => {
                    if (!response.ok) {
                        return response.json().then((error) => {
                            throw new Error(error.error);
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    alert('Клиент успешно изменен')
                    console.log('Клиент успешно изменен:');
                    console.log(data);
                    form.reset();
                })
                .catch(error => {
                    alert(error)
                    console.log('Ошибка при изменении клиента:');
                    console.error(error);
                });
        } else {
            alert('Заполните обязательные поля');
        }

        function formValidate(form) {
            let error = 0;
            let formReq = document.querySelectorAll('._req');

            for (let index = 0; index < formReq.length; index++) {
                const input = formReq[index];
                formRemoveError(input);

                if (input.classList.contains('_name')) {
                    if (nameTest(input)) {
                        formAddError(input);
                        error++;
                    }
                } else if (input.classList.contains('_ID')) {
                    if (numTest(input)) {
                        formAddError(input);
                        error++;
                    }
                } else {
                    if (input.value === '') {
                        formAddError(input);
                        error++;
                    }
                }
            }
            return error;
        }

        function formAddError(input) {
            input.parentElement.classList.add('_error');
            input.classList.add('_error');
        }
        function formRemoveError(input) {
            input.parentElement.classList.remove('_error');
            input.classList.remove('_error');
        }
        function nameTest(input) {
            return !/^[a-zA-Zа-яА-ЯёЁ]+$/.test(input.value);
        }
        function numTest(input) {
            return !/^[0-9]+$/.test(input.value);
        }
    });
</script>